# LocalMultiplayerBrowser
What does it do?
  Allows for playing local multiplayer HTML5(on canvas) games like fireboy and watergirl,Bad IceCream,etc... over the internet with another person
How does it work?
  What the code does is player 1 streams the canvas(where the game is drawn) to player 2, while player 2 sends key presses over to player 1 to be executed in player 1's browser.
  All of this is done in a peer to peer connection to try to reduce latency.
How to use?
    Player 1 adds  <a href="javascript:(function()%7B%2F*%0A%20%20%20%20Loads%20script%20from%20src%20into%20page.%20Will%20return%20promise%20that%0A%20%20%20%20waits%20for%20script%20to%20load.%0A%20*%2F%0Afunction%20loadScript(url)%7B%0A%20%20%20%20let%20script%20%3D%20document.createElement(%22script%22)%3B%0A%20%20%20%20script.src%20%3D%20url%3B%0A%20%20%20%20document.body.appendChild(script)%3B%0A%0A%20%20%20%20return%20new%20Promise((resolve%2Creject)%20%3D%3E%7B%0A%20%20%20%20%20%20%20%20script.addEventListener(%22load%22%2C()%20%3D%3E%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resolve(%22File%20loaded%22)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20script.addEventListener(%22error%22%2Ce%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20reject(e)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D)%3B%0A%7D%0A%0A%2F*%0A%20%20%20%20Creates%20a%20peer%20that%20is%20waiting%20for%20a%20connection.Once%0A%20%20%20%20connected%20to%20will%20execute%20all%20key%20presses%20the%20other%20peer%20sends.%0A%20%20%20%20Will%20stream%20selected%20canvas%20to%20other%20peer.%0A%20*%2F%0Afunction%20createPeer(canvas)%7B%0A%20%20%20%20let%20p%20%3D%20new%20Peer()%3B%0A%0A%20%20%20%20%2F%2FDestroys%20connection%20when%20window%20closes%0A%20%20%20%20window.addEventListener(%22beforeunload%22%2Ce%20%3D%3E%7B%0A%20%20%20%20%20%20%20p.destroy()%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20p.on(%22open%22%2Cid%20%3D%3E%7B%0A%20%20%20%20%20%20%20%20alert(%22Send%20this%20id%20to%20your%20friend%3A%22%20%2B%20id)%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%2F%2FReceives%20keys%20pressed%20by%20other%20peer%20and%20streams%20canvas%0A%20%20%20%20p.on(%22connection%22%2Cconn%20%3D%3E%7B%0A%20%20%20%20%20%20%20%20%2F%2FOther%20peer%20sends%20over%20json%20with%20type%20of%20keyboard%20event(data.type)%20and%20options(data.options)%0A%20%20%20%20%20%20%20%20conn.on('data'%2Cdata%20%3D%3E%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log(data)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20canvas.dispatchEvent(new%20KeyboardEvent(data.type%2Cdata.options))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2FPrompts%20user%20for%20how%20many%20frames%20to%20stream%20the%20canvas%0A%20%20%20%20%20%20%20%20let%20frames%20%3D%20%2Bprompt(%22Max%20Frame%20cap%20for%20stream(negative%20number%20for%20no%20stream)%22)%3B%0A%20%20%20%20%20%20%20%20if(frames%20!%3D%3D%20NaN%20%26%26%20frames%20%3E%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20p.call(conn.peer%2Ccanvas.captureStream(frames))%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20p.on(%22disconnected%22%2C%20e%3D%3E%7B%0A%20%20%20%20%20%20%20p.reconnect()%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20p.on(%22close%22%2C%20e%3D%3E%7B%0A%20%20%20%20%20%20%20%20p.destroy()%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20p.on(%22error%22%2C%20e%3D%3E%7B%0A%20%20%20%20%20%20%20%20alert(%22Error%3A%22%20%2B%20e.type%20%2B%20%22.%20Please%20reload%20the%20page%20an%20try%20again%22)%3B%0A%20%20%20%20%7D)%3B%0A%7D%0A%0A%2F*%0A%20%20%20%20Configures%20everything%20to%20be%20able%20to%20stream%20canvas.If%20iframe%20is%20selected%20opens%20in%20new%20tab(need%20to%20rerun%20bookmarklet).%0A%20%20%20%20Else%20will%20try%20to%20establish%20connection%20with%20other%20peer%20and%20stream%20canvas.%0A%20*%2F%0Afunction%20streamCanvas(canvas)%7B%0A%20%20%20%20loadScript(%22https%3A%2F%2Funpkg.com%2Fpeerjs%401.4.5%2Fdist%2Fpeerjs.min.js%22).then(result%20%3D%3E%7B%0A%20%20%20%20%20%20%20%20alert(%22Streaming%20canvas%3A%22%20%2B%20canvas.id)%0A%20%20%20%20%20%20%20%20createPeer(canvas)%3B%0A%20%20%20%20%7D%2C%20error%20%3D%3E%7B%0A%20%20%20%20%20%20%20%20alert(error%20%2B%20%22.%20Terminating%22)%3B%0A%20%20%20%20%7D)%3B%0A%7D%0A%0A%2F%2FIf%20user%20focused%20on%20a%20iframe%20or%20canvas%20then%20preform%20actions%0Aif(document.activeElement.tagName%20%3D%3D%3D%20%22CANVAS%22)%7B%0A%20%20%20%20streamCanvas(document.activeElement)%3B%0A%7D%0Aelse%20if(document.activeElement.tagName%20%3D%3D%3D%20%22IFRAME%22)%7B%0A%20%20%20%20alert(%22Please%20enable%20popups%22)%3B%0A%20%20%20%20window.open(document.activeElement.src)%3B%0A%7D%0Aelse%7B%0A%20%20%20%20%2F%2FPrompts%20user%20to%20select%20iframe%20or%20canvas%20if%20not%20focused%0A%20%20%20%20let%20canvases%20%3D%20document.getElementsByTagName(%22canvas%22)%3B%0A%20%20%20%20let%20iframes%20%3D%20document.getElementsByTagName(%22iframe%22)%3B%0A%20%20%20%20if(canvases.length%20%3E%200)%7B%0A%20%20%20%20%20%20%20%20let%20response%20%3D%20%22Input%20number%20for%20canvas%20you%20want%20to%20stream(-1%20if%20you%20want%20to%20open%20iframe)%3A%22%3B%0A%20%20%20%20%20%20%20%20for(let%20i%20%3D%200%3Bi%20%3C%20canvases.length%3Bi%2B%2B)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20response%20%2B%3D%20(i%20%2B%20%22.%22%20%2B%20canvases%5Bi%5D.id)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20let%20i%20%3D%20%2Bprompt(response)%3B%0A%0A%20%20%20%20%20%20%20%20if(%20isNaN(i)%20%7C%7C%20i%20%3C%20-1%20%7C%7C%20i%20%3E%3D%20canvases.length)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22Improper%20input.%20Terminating%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20streamCanvas(canvases%5Bi%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%20if(iframes.length%20%3E%200)%7B%0A%20%20%20%20%20%20%20%20let%20response%20%3D%20%22Input%20number%20for%20iframe%20you%20want%20to%20open%20in%20new%20window%3A%22%3B%0A%20%20%20%20%20%20%20%20for(let%20i%20%3D%200%3Bi%20%3C%20iframes.length%3Bi%2B%2B)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20response%20%2B%3D%20(i%20%2B%20%22.%22%20%2B%20iframes%5Bi%5D.id)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20let%20i%20%3D%20%2Bprompt(response)%3B%0A%0A%20%20%20%20%20%20%20%20if(%20isNaN(i)%20%7C%7C%20i%20%3C%200%20%7C%7C%20i%20%3E%3D%20iframes.length)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22Improper%20input.%20Terminating%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20window.open(iframes%5Bi%5D.src)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%7B%0A%20%20%20%20%20%20%20%20alert(%22Sorry%20cant%20play%20the%20game%20multiplayer%22)%3B%0A%20%20%20%20%7D%0A%7D%7D)()%3B">bookmark</a> 
    to bookmarks in browser. Player then goes to site that hosts the game they want. Then wait for the game to load and click on the game to get focus. Click on the bookmark you added to your browser. From there follow the popup instructions(you might need to enable popups for the site).
    If you selected an iframe(a website inside a website that is often used for security purposes) first enable popups.A new tab will open.You may close the previous tab.
    On the new tab repeat instructions as though it was a new site(Focus on canvas,click bookmark,etc...).You may need to do this multiple times if there is a website nested in a website nested in a website ... .
    Eventually an id will popup. Send this to Player 2(through email,discord,messenger,etc). Player 2 will go on the site https://seamoose44499958.github.io/LocalMultiplayerBrowser/ and input that id.
    Player 2 will right click on the videoan unpause the stream. Now you can start playing.
